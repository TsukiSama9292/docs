# 網路設定

# Ubuntu Server : netplan

1. 編輯禁止網路配置
    
    ```bash
    sudo nano /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg
    ```
    
    ```bash
    network: {config: disabled}
    ```
    
2. 編輯網路配置
    
    ```
    sudo nano /etc/netplan/50-cloud-init.yaml
    ```
    
    ```bash
    network:
        ethernets:
            ens18:
                addresses:
                    - 192.168.0.<number>/24 # 範例 IP
                routes:
                    - to: 0.0.0.0/0
                      via: 192.168.0.1 # 範例路由
                nameservers:
                    addresses:
                        - 8.8.8.8 # 建議換成機構 NDS
                        - 1.1.1.1 # 建議換成機構 NDS
        version: 2
    ```
    
3. 配置完成，採用配置
    
    ```bash
    sudo netplan apply
    ```
    

# Debian

1. 編輯配置
    
    ```bash
    sudo nano /etc/network/interfaces
    ```
    
    ```bash
    allow-hotplug ens18
    auto ens18
    iface ens18 inet static
        pre-up ip addr flush dev ens18 || true
        address 192.168.0.<number> # 範例 IP
        netmask 255.255.255.0 # 範例遮罩
        gateway 192.168.0.1 # 範例路由
        dns-nameservers 8.8.8.8 1.1.1.1 # 建議換成機構 NDS
    
    # pre-up ip addr flush dev ens18 || true
    # 確保 qemu-guest-agent 不有想 IP 獲取
    ```
    
2. 修復 DNS 解析問題
    
    ```bash
    sudo chattr -i /etc/resolv.conf 2>/dev/null || true
    # 建議換成機構 NDS
    sudo tee /etc/resolv.conf <<'EOF'
    nameserver 1.1.1.1
    nameserver 8.8.8.8
    EOF
    # 避免被改壞 DNS 解析
    sudo chattr +i /etc/resolv.conf
    ```
    
3. 重新啟動 networking
    
    ```bash
    sudo systemctl restart networking
    ```